"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateTsConfigServerJsonForBrowserBuilder = exports.setServerTsConfigOptionsForApplicationBuilder = void 0;
const devkit_1 = require("@nx/devkit");
const path_1 = require("path");
function setServerTsConfigOptionsForApplicationBuilder(tree, options) {
    const { targets } = (0, devkit_1.readProjectConfiguration)(tree, options.project);
    const tsConfigPath = targets.build.options.tsConfig;
    (0, devkit_1.updateJson)(tree, tsConfigPath, (json) => {
        json.files ??= [];
        json.files.push((0, devkit_1.joinPathFragments)('src', options.main), (0, devkit_1.joinPathFragments)(options.serverFileName));
        json.compilerOptions ??= {};
        json.compilerOptions.types ??= [];
        json.compilerOptions.types.push('node');
        return json;
    });
}
exports.setServerTsConfigOptionsForApplicationBuilder = setServerTsConfigOptionsForApplicationBuilder;
function generateTsConfigServerJsonForBrowserBuilder(tree, options) {
    const { root } = (0, devkit_1.readProjectConfiguration)(tree, options.project);
    (0, devkit_1.generateFiles)(tree, (0, path_1.join)(__dirname, '..', 'files', 'root'), root, {
        ...options,
        tpl: '',
    });
}
exports.generateTsConfigServerJsonForBrowserBuilder = generateTsConfigServerJsonForBrowserBuilder;
